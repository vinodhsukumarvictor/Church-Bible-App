"use strict";(()=>{var e={};e.id=559,e.ids=[559],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6758:(e,t,o)=>{o.r(t),o.d(t,{config:()=>d,default:()=>i,routeModule:()=>l});var n={};o.r(n),o.d(n,{default:()=>handler});var a=o(1802),r=o(7153),s=o(6249);async function handler(e,t){try{let o=process.env.YOUTUBE_API_KEY;if(!o)return t.status(500).json({error:"YOUTUBE_API_KEY not configured"});let n=e.query.handle||"@FCMLiverpool",a=e.query.max||6,r=`https://www.googleapis.com/youtube/v3/search?key=${encodeURIComponent(o)}&q=${encodeURIComponent(n)}&type=channel&part=snippet&maxResults=1`,s=await fetch(r);if(!s.ok){let e=await s.text();return t.status(s.status).json({error:"Channel lookup failed",detail:e})}let i=await s.json(),d=i.items?.[0]?.snippet?.channelId,l=null;if(d){let e=`https://www.googleapis.com/youtube/v3/search?key=${encodeURIComponent(o)}&channelId=${encodeURIComponent(d)}&part=snippet,id&order=date&maxResults=${encodeURIComponent(a)}&type=video`,n=await fetch(e);if(!n.ok){let e=await n.text();return t.status(n.status).json({error:"Channel videos fetch failed",detail:e})}l=await n.json()}else{let e=`https://www.googleapis.com/youtube/v3/search?key=${encodeURIComponent(o)}&q=${encodeURIComponent(n+" sermon")}&type=video&order=date&part=snippet&maxResults=${encodeURIComponent(a)}`,r=await fetch(e);if(!r.ok){let e=await r.text();return t.status(r.status).json({error:"Direct video search failed",detail:e})}l=await r.json()}let u=(l.items||[]).map(e=>{let t=e.id&&(e.id.videoId||e.id);return{title:e.snippet?.title||"Untitled",speaker:e.snippet?.channelTitle||"FCM Liverpool",youtubeId:"string"==typeof t?t:"",date:e.snippet?.publishedAt?new Date(e.snippet.publishedAt).toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"}):""}}).filter(e=>e.youtubeId);return t.status(200).json({items:u})}catch(e){return console.error("fetchYouTube error:",e),t.status(500).json({error:"Internal error",message:e.message})}}let i=(0,s.l)(n,"default"),d=(0,s.l)(n,"config"),l=new a.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/fetchYouTube",pathname:"/api/fetchYouTube",bundlePath:"",filename:""},userland:n})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),o=t.X(0,[222],()=>__webpack_exec__(6758));module.exports=o})();