(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5728:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(7241)}])},7241:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return HomePage}});var t=s(5893),n=s(9008),i=s.n(n),l=s(4298),r=s.n(l),c=s(7294),d=s(571);function Auth(){var e,a;let{user:n,signIn:i,signUp:l,signOut:r}=(0,d.a)(),[o,m]=(0,c.useState)(!1),[h,u]=(0,c.useState)(""),[p,x]=(0,c.useState)(""),[f,g]=(0,c.useState)(""),[j,v]=(0,c.useState)(!1);async function handleSignIn(){g("Signing in…");try{let{error:e}=await i({email:h,password:p});if(e){g("Error: ".concat(e.message));return}g("Signed in"),u(""),x(""),setTimeout(()=>m(!1),500)}catch(e){g("Sign in failed")}}async function handleSignUp(){g("Creating account…");try{let{error:e,data:a}=await l({email:h,password:p});if(e){g("Error: ".concat(e.message));return}if(null==a?void 0:a.user)try{let{supabase:e}=await Promise.resolve().then(s.bind(s,8523)),t=h.split("@")[0];await e.from("profiles").upsert({id:a.user.id,full_name:t})}catch(e){}g("Account created. Check your email if confirmation is required."),u(""),x("")}catch(e){g("Sign up failed")}}async function handleSignOut(){try{await r(),g("Signed out"),m(!1)}catch(e){g("Sign out failed")}}let b=((null==n?void 0:null===(e=n.user_metadata)||void 0===e?void 0:e.full_name)||(null==n?void 0:n.email)||"?").charAt(0).toUpperCase();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{id:"profileModal",className:"modal ".concat(o?"visible":""),hidden:!o,children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("button",{className:"modal-close",onClick:()=>m(!1),"aria-label":"Close",children:(0,t.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,t.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})}),(0,t.jsxs)("div",{className:"profile-info mb-4",children:[(0,t.jsx)("div",{className:"profile-avatar text-2xl font-bold w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-indigo-600 text-white flex items-center justify-center",children:b}),(0,t.jsx)("h2",{className:"font-semibold mt-3",children:n?(null===(a=n.user_metadata)||void 0===a?void 0:a.full_name)||n.email||"Signed in":"Not signed in"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:n?n.email:"Sign in or create an account"})]}),(0,t.jsxs)("div",{className:"auth-form space-y-3",children:[n?(0,t.jsx)("button",{className:"btn warn w-full",onClick:handleSignOut,children:"Sign out"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"small muted",htmlFor:"authEmail",children:"Email"}),(0,t.jsx)("input",{id:"authEmail",type:"email",placeholder:"you@example.com",autoComplete:"email",value:h,onChange:e=>u(e.target.value),className:"input-field w-full"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"small muted",htmlFor:"authPassword",children:"Password"}),(0,t.jsx)("input",{id:"authPassword",type:"password",placeholder:"Password",autoComplete:j?"new-password":"current-password",value:p,onChange:e=>x(e.target.value),className:"input-field w-full"})]}),(0,t.jsxs)("div",{className:"auth-actions flex gap-2",children:[(0,t.jsx)("button",{className:"btn primary flex-1",onClick:j?handleSignUp:handleSignIn,children:j?"Sign up":"Sign in"}),(0,t.jsx)("button",{className:"btn flex-1",onClick:()=>v(!j),children:j?"Back":"Create account"})]})]}),(0,t.jsx)("p",{id:"authStatus",className:"small muted","aria-live":"polite",children:f})]})]})}),(0,t.jsx)("button",{className:"profile-btn w-8 h-8 rounded-full font-bold text-white bg-gradient-to-br from-purple-400 to-indigo-600 flex items-center justify-center",onClick:()=>m(!0),"aria-label":"Profile",children:b})]})}/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,s)=>s?s.toUpperCase():a.toLowerCase()),toPascalCase=e=>{let a=toCamelCase(e);return a.charAt(0).toUpperCase()+a.slice(1)},mergeClasses=(...e)=>e.filter((e,a,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===a).join(" ").trim(),hasA11yProp=e=>{for(let a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,c.forwardRef)(({color:e="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:t,className:n="",children:i,iconNode:l,...r},d)=>(0,c.createElement)("svg",{ref:d,...o,width:a,height:a,stroke:e,strokeWidth:t?24*Number(s)/Number(a):s,className:mergeClasses("lucide",n),...!i&&!hasA11yProp(r)&&{"aria-hidden":"true"},...r},[...l.map(([e,a])=>(0,c.createElement)(e,a)),...Array.isArray(i)?i:[i]])),createLucideIcon=(e,a)=>{let s=(0,c.forwardRef)(({className:s,...t},n)=>(0,c.createElement)(m,{ref:n,iconNode:a,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,s),...t}));return s.displayName=toPascalCase(e),s},h=createLucideIcon("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);function Header(){let{user:e}=(0,d.a)();return(0,t.jsx)("header",{className:"bg-white/60 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-40",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-primary-500 text-white rounded flex items-center justify-center font-bold",children:"BR"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:"Bible Reader"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Track your reading progress"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{className:"p-2 rounded hover:bg-gray-100","aria-label":"Menu",children:(0,t.jsx)(h,{size:18})}),(0,t.jsx)(Auth,{})]})]})})}function Layout(e){let{children:a}=e;return(0,t.jsxs)("div",{className:"min-h-screen bg-background text-foreground",children:[(0,t.jsx)(Header,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto px-4 py-6",children:a})]})}var u=s(8523);let p={canonical:"/reading-plan-canonical.json",chronological:"/reading-plan-chronological.json"};function Plans(){let{user:e}=(0,d.a)(),[a,s]=(0,c.useState)({canonical:null,chronological:null}),[n,i]=(0,c.useState)("canonical"),[l,r]=(0,c.useState)(null),[o,m]=(0,c.useState)(!0),[h,x]=(0,c.useState)(!1),[f,g]=(0,c.useState)("");(0,c.useEffect)(()=>{let e=!0;return async function(){m(!0);let a=await Promise.all(Object.entries(p).map(async e=>{let[a,s]=e;try{let e=await fetch(s);if(!e.ok)return[a,null];let t=await e.json();return[a,t]}catch(e){return console.warn("Failed to load plan",a,e),[a,null]}}));if(!e)return;let t=Object.fromEntries(a);s(t);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,a=new Date(e.getFullYear(),0,0);return Math.floor((e-a)/864e5)}(),i=t.canonical?Object.keys(t.canonical).length:0;r(String(i?n%i||i:1)),m(!1)}(),()=>{e=!1}},[]);let j=(0,c.useMemo)(()=>{let e=a[n];return e?Object.keys(e).sort((e,a)=>Number(e)-Number(a)):[]},[a,n]),v=(0,c.useMemo)(()=>a[n]&&l&&a[n][l]||[],[a,n,l]);return o?(0,t.jsx)("div",{className:"p-6",children:"Loading plans…"}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83D\uDCDA Reading Plans"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Track your daily Bible reading journey"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("select",{className:"input-field",value:n,onChange:e=>i(e.target.value),children:[(0,t.jsx)("option",{value:"canonical",children:"Canonical (Genesis → Revelation)"}),(0,t.jsx)("option",{value:"chronological",children:"Chronological"})]}),(0,t.jsx)("select",{className:"input-field w-32",value:l||"",onChange:e=>r(e.target.value),children:j.map(e=>(0,t.jsxs)("option",{value:e,children:["Day ",e]},e))})]})]}),(0,t.jsxs)("div",{className:"card-elevated p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Selected Day"}),(0,t.jsxs)("div",{className:"text-lg font-medium",children:["Day ",l]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{className:"btn-primary",onClick:async()=>{if(!e){g("Please sign in to save progress");return}if(l){x(!0),g("Saving...");try{let a=Number(l),{data:s,error:t}=await u.supabase.from("reading_progress").select("completed_days").eq("user_id",e.id).eq("plan_name",n).maybeSingle(),i=[];s&&s.completed_days&&(i=Array.isArray(s.completed_days)?s.completed_days.slice():s.completed_days),(i=i.map(e=>Number(e)).filter(e=>!Number.isNaN(e))).includes(a)||i.push(a);let{error:r}=await u.supabase.from("reading_progress").upsert({user_id:e.id,plan_name:n,completed_days:i},{returning:"minimal"});if(r)throw r;g("Saved")}catch(e){console.error("Failed to save progress",e),g("Failed to save. See console.")}finally{x(!1),setTimeout(()=>g(""),2500)}}},disabled:h,children:h?"Saving…":"Mark day completed"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground mt-2",children:f})]})]}),(0,t.jsx)("ul",{className:"divide-y divide-gray-100",children:v.map((e,a)=>(0,t.jsxs)("li",{className:"py-3 flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.book}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Chapter ",e.chapter]})]}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.chapter})]},"".concat(e.book,"-").concat(e.chapter,"-").concat(a)))})]})]})}function Home(){let[e,a]=(0,c.useState)({text:"Loading…",ref:""}),[s,n]=(0,c.useState)([]),[i,l]=(0,c.useState)([]),[r,d]=(0,c.useState)(null);return(0,c.useEffect)(()=>{let e=!0;async function loadAnnouncements(){try{let a=await fetch("/announcements_en.json");if(!a.ok)return;let s=await a.json();e&&n(s.slice(0,6))}catch(e){console.warn("loadAnnouncements failed",e)}}async function loadSermons(){try{let a=await fetch("/sermons.json");if(!a.ok)return;let s=await a.json();e&&l((s.items||s).slice(0,6))}catch(e){console.warn("loadSermons failed",e)}}async function loadQuiz(){try{let a=await fetch("/quiz_en.json");if(!a.ok)return;let s=await a.json();e&&d(s[0]||null)}catch(e){console.warn("loadQuiz failed",e)}}return async function(){try{let s=await fetch("/verses-en.json");if(!s.ok)return;let t=await s.json(),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,a=new Date(e.getFullYear(),0,0);return Math.floor((e-a)/864e5)}()%t.length,i=t[n];e&&a({text:i.text||i.verse||"—",ref:i.ref||i.book||""})}catch(e){console.warn("loadVerse failed",e)}}(),loadAnnouncements(),loadSermons(),loadQuiz(),()=>{e=!1}},[]),(0,t.jsxs)("section",{id:"home-view",className:"card view-panel",children:[(0,t.jsxs)("section",{id:"verse",className:"card verse-card mb-6 p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Verse of the day ✨"}),(0,t.jsx)("blockquote",{className:"mt-2 text-base text-foreground/90",children:e.text}),(0,t.jsx)("p",{className:"muted mt-2",children:e.ref}),(0,t.jsx)("div",{className:"verse-actions mt-3",children:(0,t.jsxs)("button",{id:"verseLikeBtn",className:"action-btn inline-flex items-center gap-2","aria-label":"Like verse",children:[(0,t.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{display:"inline-block",verticalAlign:"middle"},children:(0,t.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"})}),(0,t.jsx)("span",{id:"verseLikeCount",children:"0"})]})})]}),(0,t.jsxs)("div",{className:"home-grid grid gap-6 md:grid-cols-3",children:[(0,t.jsxs)("section",{className:"home-card p-4 bg-card rounded-lg shadow-sm",children:[(0,t.jsxs)("div",{className:"home-card-head mb-3",children:[(0,t.jsx)("p",{className:"eyebrow text-sm text-muted-foreground",children:"Church"}),(0,t.jsx)("h3",{className:"text-base font-medium",children:"Announcements"}),(0,t.jsx)("p",{className:"small text-muted-foreground",children:"Stay updated with the latest news"})]}),(0,t.jsx)("ul",{id:"homeAnnouncements",className:"list space-y-2",children:s.map((e,a)=>(0,t.jsxs)("li",{className:"py-2 border-b border-gray-100",children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.content?e.content.substring(0,120)+(e.content.length>120?"…":""):""})]},a))})]}),(0,t.jsxs)("section",{className:"home-card p-4 bg-card rounded-lg shadow-sm",children:[(0,t.jsxs)("div",{className:"home-card-head mb-3",children:[(0,t.jsx)("p",{className:"eyebrow text-sm text-muted-foreground",children:"Sermons"}),(0,t.jsx)("h3",{className:"text-base font-medium",children:"Recent Sermons"}),(0,t.jsx)("p",{className:"small text-muted-foreground",children:"Watch or listen on the go"})]}),(0,t.jsx)("div",{id:"homeSermons",className:"sermon-grid grid gap-3",children:i.map((e,a)=>(0,t.jsxs)("div",{className:"p-3 border rounded",children:[(0,t.jsx)("div",{className:"font-medium",children:e.title||e.name}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.date||e.published||""})]},a))})]}),(0,t.jsxs)("section",{className:"home-card p-4 bg-card rounded-lg shadow-sm",children:[(0,t.jsxs)("div",{className:"home-card-head mb-3",children:[(0,t.jsx)("p",{className:"eyebrow text-sm text-muted-foreground",children:"Quiz"}),(0,t.jsx)("h3",{className:"text-base font-medium",children:"Daily Bible Quiz"}),(0,t.jsx)("p",{className:"small text-muted-foreground",children:"Test your knowledge and track streaks"})]}),(0,t.jsx)("div",{id:"quizContainer",className:"quiz-box",children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{id:"quizQuestion",className:"quiz-question",children:r.q}),(0,t.jsx)("div",{id:"quizOptions",className:"quiz-options space-y-2",children:(r.options||[]).map((e,a)=>(0,t.jsx)("button",{className:"w-full text-left p-2 border rounded",children:e},a))}),(0,t.jsx)("div",{id:"quizFeedback",className:"quiz-feedback mt-2","aria-live":"polite"})]}):(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"No quiz available"})})]})]})]})}function Admin(){let{user:e,loading:a}=(0,d.a)(),[s,n]=(0,c.useState)([]),[i,l]=(0,c.useState)(!1),[r,o]=(0,c.useState)(null),[m,h]=(0,c.useState)([]),[p,x]=(0,c.useState)(!1),[f,g]=(0,c.useState)([]),[j,v]=(0,c.useState)(null),[b,N]=(0,c.useState)(!1);async function fetchProfiles(){l(!0),o(null);try{let{data:e,error:a}=await u.supabase.from("profiles").select("id, full_name, role, created_at, email").order("created_at",{ascending:!1});if(a)throw a;n(e||[])}catch(e){console.warn("Could not load profiles",e),o(e.message||String(e)),n([])}finally{l(!1)}}async function fetchAudit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;x(!0);try{var a,s;let t=null===(s=(await u.supabase.auth.getSession()).data)||void 0===s?void 0:null===(a=s.session)||void 0===a?void 0:a.access_token,n=new URLSearchParams;n.set("limit","25"),e&&n.set("after",e);let i="/api/admin/audit?".concat(n.toString()),l=await fetch(i,{headers:{Authorization:t?"Bearer ".concat(t):""}});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((null==e?void 0:e.error)||"Failed to load audit")}let r=await l.json();return h(r.data||[]),N(!!r.has_more),r.next_cursor||null}catch(e){return console.warn("Failed to fetch audit",e),h([]),N(!1),null}finally{x(!1)}}async function changeRole(e,a){if(confirm("Change role for user ".concat(e," to ").concat(a,"?")))try{var s,t;let n=null===(t=(await u.supabase.auth.getSession()).data)||void 0===t?void 0:null===(s=t.session)||void 0===s?void 0:s.access_token,i=await fetch("/api/admin/changeRole",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n?"Bearer ".concat(n):""},body:JSON.stringify({targetUserId:e,newRole:a})}),l=await i.json();if(!i.ok)throw Error((null==l?void 0:l.error)||"Request failed");await fetchProfiles(),alert("Role updated")}catch(e){console.error("Could not update role",e),alert("Could not update role: "+(e.message||e))}}return((0,c.useEffect)(()=>{e&&(fetchProfiles(),(async()=>{await fetchAudit(null),v(null),g([])})())},[e]),a)?(0,t.jsx)("div",{className:"p-6",children:"Checking authentication…"}):e?(0,t.jsxs)("section",{id:"admin-view",className:"card view-panel",children:[(0,t.jsx)("div",{className:"plans-header mb-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Admin Console"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage users, promotions, and moderation queues"})]})}),(0,t.jsxs)("div",{className:"admin-panel",children:[(0,t.jsx)("h3",{className:"text-base font-medium mb-2",children:"Users"}),i&&(0,t.jsx)("div",{children:"Loading users…"}),r&&(0,t.jsx)("div",{className:"text-sm text-destructive",children:r}),!i&&!s.length&&(0,t.jsx)("div",{className:"small muted",children:"No users found or insufficient permissions."}),s.length>0&&(0,t.jsx)("div",{className:"overflow-auto border rounded",children:(0,t.jsxs)("table",{className:"min-w-full divide-y",children:[(0,t.jsx)("thead",{className:"bg-secondary p-2",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Name / Email"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Role"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Joined"}),(0,t.jsx)("th",{className:"px-4 py-2",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-card divide-y",children:s.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-4 py-3",children:[(0,t.jsx)("div",{className:"font-medium",children:e.full_name||e.id}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email||""})]}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.role||"member"}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.created_at?new Date(e.created_at).toLocaleString():""}),(0,t.jsxs)("td",{className:"px-4 py-3 text-center space-x-2",children:[(0,t.jsx)("button",{className:"btn",onClick:()=>changeRole(e.id,"admin"),children:"Promote"}),(0,t.jsx)("button",{className:"btn warn",onClick:()=>changeRole(e.id,"member"),children:"Demote"})]})]},e.id))})]})}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h3",{className:"text-base font-medium",children:"Audit Log"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{className:"btn",onClick:async()=>{await fetchAudit(j)},disabled:p,children:p?"Loading…":"Refresh"}),(0,t.jsx)("button",{className:"btn",onClick:async()=>{if(0===f.length)return;let e=f[f.length-1]||null,a=f.slice(0,-1);g(a),v(e||null),await fetchAudit(e||null)},disabled:p||0===f.length,children:"Prev"}),(0,t.jsx)("button",{className:"btn",onClick:async()=>{let e=await fetchAudit(j);e&&(g(e=>[...e,j]),v(e))},disabled:p||!b,children:"Next"})]})]}),p&&(0,t.jsx)("div",{children:"Loading audit…"}),!p&&0===m.length&&(0,t.jsx)("div",{className:"small muted",children:"No recent audit entries."}),m.length>0&&(0,t.jsx)("div",{className:"overflow-auto border rounded",children:(0,t.jsxs)("table",{className:"min-w-full text-sm",children:[(0,t.jsx)("thead",{className:"bg-secondary",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-3 py-2 text-left",children:"When"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left",children:"Actor"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left",children:"Target"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left",children:"Change"}),(0,t.jsx)("th",{className:"px-3 py-2 text-left",children:"Reason"})]})}),(0,t.jsx)("tbody",{children:m.map(e=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"px-3 py-2",children:new Date(e.created_at).toLocaleString()}),(0,t.jsxs)("td",{className:"px-3 py-2",children:[(0,t.jsx)("div",{className:"font-medium",children:e.changed_by_name||e.changed_by}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.changed_by_email||""})]}),(0,t.jsxs)("td",{className:"px-3 py-2",children:[(0,t.jsx)("div",{className:"font-medium",children:e.target_user_name||e.target_user}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.target_user_email||""})]}),(0,t.jsxs)("td",{className:"px-3 py-2",children:[e.old_role||"—"," → ",e.new_role||"—"]}),(0,t.jsx)("td",{className:"px-3 py-2",children:e.reason||(e.details?JSON.stringify(e.details):"")})]},e.id))})]})})]})]})]}):(0,t.jsx)("div",{className:"p-6",children:"Sign in as an admin to manage users."})}let x=[{id:"genesis",name:"Genesis",chapters:50},{id:"exodus",name:"Exodus",chapters:40},{id:"leviticus",name:"Leviticus",chapters:27},{id:"numbers",name:"Numbers",chapters:36},{id:"deuteronomy",name:"Deuteronomy",chapters:34},{id:"joshua",name:"Joshua",chapters:24},{id:"judges",name:"Judges",chapters:21},{id:"ruth",name:"Ruth",chapters:4},{id:"1-samuel",name:"1 Samuel",chapters:31},{id:"2-samuel",name:"2 Samuel",chapters:24},{id:"1-kings",name:"1 Kings",chapters:22},{id:"2-kings",name:"2 Kings",chapters:25},{id:"1-chronicles",name:"1 Chronicles",chapters:29},{id:"2-chronicles",name:"2 Chronicles",chapters:36},{id:"ezra",name:"Ezra",chapters:10},{id:"nehemiah",name:"Nehemiah",chapters:13},{id:"esther",name:"Esther",chapters:10},{id:"job",name:"Job",chapters:42},{id:"psalms",name:"Psalms",chapters:150},{id:"proverbs",name:"Proverbs",chapters:31},{id:"ecclesiastes",name:"Ecclesiastes",chapters:12},{id:"song-of-solomon",name:"Song of Solomon",chapters:8},{id:"isaiah",name:"Isaiah",chapters:66},{id:"jeremiah",name:"Jeremiah",chapters:52},{id:"lamentations",name:"Lamentations",chapters:5},{id:"ezekiel",name:"Ezekiel",chapters:48},{id:"daniel",name:"Daniel",chapters:12},{id:"hosea",name:"Hosea",chapters:14},{id:"joel",name:"Joel",chapters:3},{id:"amos",name:"Amos",chapters:9},{id:"obadiah",name:"Obadiah",chapters:1},{id:"jonah",name:"Jonah",chapters:4},{id:"micah",name:"Micah",chapters:7},{id:"nahum",name:"Nahum",chapters:3},{id:"habakkuk",name:"Habakkuk",chapters:3},{id:"zephaniah",name:"Zephaniah",chapters:3},{id:"haggai",name:"Haggai",chapters:2},{id:"zechariah",name:"Zechariah",chapters:14},{id:"malachi",name:"Malachi",chapters:4},{id:"matthew",name:"Matthew",chapters:28},{id:"mark",name:"Mark",chapters:16},{id:"luke",name:"Luke",chapters:24},{id:"john",name:"John",chapters:21},{id:"acts",name:"Acts",chapters:28},{id:"romans",name:"Romans",chapters:16},{id:"1-corinthians",name:"1 Corinthians",chapters:16},{id:"2-corinthians",name:"2 Corinthians",chapters:13},{id:"galatians",name:"Galatians",chapters:6},{id:"ephesians",name:"Ephesians",chapters:6},{id:"philippians",name:"Philippians",chapters:4},{id:"colossians",name:"Colossians",chapters:4},{id:"1-thessalonians",name:"1 Thessalonians",chapters:5},{id:"2-thessalonians",name:"2 Thessalonians",chapters:3},{id:"1-timothy",name:"1 Timothy",chapters:6},{id:"2-timothy",name:"2 Timothy",chapters:4},{id:"titus",name:"Titus",chapters:3},{id:"philemon",name:"Philemon",chapters:1},{id:"hebrews",name:"Hebrews",chapters:13},{id:"james",name:"James",chapters:5},{id:"1-peter",name:"1 Peter",chapters:5},{id:"2-peter",name:"2 Peter",chapters:3},{id:"1-john",name:"1 John",chapters:5},{id:"2-john",name:"2 John",chapters:1},{id:"3-john",name:"3 John",chapters:1},{id:"jude",name:"Jude",chapters:1},{id:"revelation",name:"Revelation",chapters:22}];function Books(){let{user:e}=(0,d.a)(),[a,s]=(0,c.useState)("genesis"),[n,i]=(0,c.useState)({}),[l,r]=(0,c.useState)(!1),[o,m]=(0,c.useState)(!1),[h,p]=(0,c.useState)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,a=new Date(e.getFullYear(),0,0);return Math.floor((e-a)/864e5)}());(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{function handleOpenBook(e){try{var a;let t=null==e?void 0:null===(a=e.detail)||void 0===a?void 0:a.bookId;t&&s(t)}catch(e){}}function handleOpenChapter(e){try{let{bookId:a,chapter:t}=(null==e?void 0:e.detail)||{};a&&s(a),t&&setTimeout(()=>{let e=document.querySelector("#chaptersContainer .chapter");e&&e.scrollIntoView({behavior:"smooth",block:"center"})},120)}catch(e){}}return window.addEventListener("openBibleBook",handleOpenBook),window.addEventListener("openBibleChapter",handleOpenChapter),()=>{window.removeEventListener("openBibleBook",handleOpenBook),window.removeEventListener("openBibleChapter",handleOpenChapter)}},[]);let f=(0,c.useMemo)(()=>Object.fromEntries(x.map(e=>[e.id,e])),[]);function findBookIdByName(e){if(!e)return null;let a=String(e).toLowerCase().replace(/\s+/g," ").trim(),s=x.find(e=>e.name.toLowerCase()===a);return s||(s=x.find(e=>e.name.toLowerCase().startsWith(a)||a.startsWith(e.name.toLowerCase())))?s.id:(s=x.find(e=>e.id.replace(/-/g,"").toLowerCase()===a.replace(/\s+/g,"").toLowerCase()))?s.id:null}async function toggleChapter(a,s){i(e=>{let t={...e};t[a]={...t[a]||{}};let n=!!t[a][s];return n?delete t[a][s]:t[a][s]=!0,t});try{var t;if(!e)return;await u.supabase.rpc("mark_chapter_progress",{p_plan_name:window.getSelectedPlanName?window.getSelectedPlanName():"canonical",p_book:(null===(t=f[a])||void 0===t?void 0:t.name)||a,p_chapter:s,p_completed:!0})}catch(e){console.warn("mark_chapter_progress RPC failed",e)}}async function markAllVisible(){try{let s=!window.getPlanEntriesForDay||l||o?null:window.getPlanEntriesForDay(h);if(s&&s.length){let t={...n};for(let n of s){let s=findBookIdByName(n.book)||a;t[s]=t[s]||{},t[s][n.chapter]=!0;try{e&&await u.supabase.rpc("mark_chapter_progress",{p_plan_name:window.getSelectedPlanName?window.getSelectedPlanName():"canonical",p_book:n.book,p_chapter:n.chapter,p_completed:!0})}catch(e){console.warn("markAll remote sync failed",e)}}i(t);return}let t=f[a],r={...n};r[t.id]={};for(let e=1;e<=t.chapters;e++)r[t.id][e]=!0;i(r)}catch(e){console.warn("markAll failed",e)}}async function clearVisible(){try{let s=!window.getPlanEntriesForDay||l||o?null:window.getPlanEntriesForDay(h);if(s&&s.length){let t={...n};for(let n of s){let s=findBookIdByName(n.book)||a;t[s]&&t[s][n.chapter]&&delete t[s][n.chapter];try{e&&await u.supabase.rpc("mark_chapter_progress",{p_plan_name:window.getSelectedPlanName?window.getSelectedPlanName():"canonical",p_book:n.book,p_chapter:n.chapter,p_completed:!1})}catch(e){}}i(t);return}let t={...n};delete t[a],i(t)}catch(e){console.warn("clearVisible failed",e)}}return(0,t.jsxs)("section",{id:"books-view",className:"card view-panel",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Books & Chapters"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Track chapter-level progress"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{className:"btn",onClick:()=>{p(e=>Math.max(1,e-1))},children:"‹"}),(0,t.jsxs)("div",{className:"text-sm",children:["Day ",h]}),(0,t.jsx)("button",{className:"btn",onClick:()=>{p(e=>e+1)},children:"›"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,t.jsx)("aside",{className:"col-span-1",children:(0,t.jsx)("div",{className:"books-list",children:x.map(e=>{let i=function(e){let a=f[e],s=Object.keys(n[e]||{}).length,t=Math.round(s/((null==a?void 0:a.chapters)||1)*100);return{readCount:s,total:(null==a?void 0:a.chapters)||0,pct:t}}(e.id);return(0,t.jsxs)("div",{className:"book-item ".concat(e.id===a?"active":""),onClick:()=>s(e.id),children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[i.readCount," / ",i.total]})]},e.id)})})}),(0,t.jsxs)("main",{className:"col-span-3",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-3",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:l,onChange:e=>{r(e.target.checked),e.target.checked&&m(!1)}})," Show all chapters"]}),(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:o,onChange:e=>{m(e.target.checked),e.target.checked&&r(!1)}})," Show missed"]}),(0,t.jsxs)("div",{className:"ml-auto flex gap-2",children:[(0,t.jsx)("button",{className:"btn",onClick:markAllVisible,children:"Mark all visible"}),(0,t.jsx)("button",{className:"btn warn",onClick:clearVisible,children:"Clear visible"})]})]}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",s=f[a];if(!s)return null;let i=!window.getPlanEntriesForDay||l||o?null:window.getPlanEntriesForDay(h);if(i&&i.length>0&&!l)return(0,t.jsx)("div",{className:"plan-entries-list",children:i.map((s,i)=>{let l=findBookIdByName(s.book)||a,r=!!(n[l]&&n[l][s.chapter]);return"read"===e&&!r||"unread"===e&&r?null:(0,t.jsxs)("div",{className:"plan-entry flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("input",{type:"checkbox",checked:r,onChange:()=>toggleChapter(l,s.chapter)}),(0,t.jsxs)("div",{children:[s.book," ",s.chapter]})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Day ",s.day]})]},"".concat(s.book,"-").concat(s.chapter,"-").concat(i))})});let r=[];for(let e=1;e<=s.chapters;e++)r.push(e);return(0,t.jsx)("div",{className:"chapters-grid grid gap-2 grid-cols-8",children:r.map(a=>{let i=!!(n[s.id]&&n[s.id][a]);return"read"===e&&!i||"unread"===e&&i?null:(0,t.jsx)("button",{className:"chapter ".concat(i?"read":""," p-2 border rounded"),onClick:()=>toggleChapter(s.id,a),children:a},a)})})}()]})]})]})}function BooksSidebar(){let[e,a]=(0,c.useState)(null),s=(0,c.useMemo)(()=>x.reduce((e,a)=>e+(a.chapters||0),0),[]);(0,c.useEffect)(()=>{let e=!0;return(async()=>{try{let{data:s,error:t}=await u.supabase.from("reading_progress_summary").select("chapters_read");if(t||!s)return;let n=s.reduce((e,a)=>e+(a.chapters_read||0),0);e&&a(n)}catch(e){}})(),()=>{e=!1}},[]);let n=null!=e?Math.round(e/s*100):0;return(0,t.jsxs)("aside",{children:[(0,t.jsxs)("div",{className:"overall",children:[(0,t.jsxs)("svg",{className:"donut",viewBox:"0 0 36 36",children:[(0,t.jsx)("circle",{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:"rgba(255,255,255,0.06)",strokeWidth:"4"}),(0,t.jsx)("circle",{cx:"18",cy:"18",r:"15.9",fill:"none",stroke:"url(#gradient)",strokeWidth:"4",strokeLinecap:"round",transform:"rotate(-90 18 18)",style:{strokeDasharray:"".concat(n," 100")}})]}),(0,t.jsxs)("div",{className:"overall-stats",children:[(0,t.jsx)("p",{className:"small",children:"Overall progress"}),(0,t.jsx)("div",{className:"progress-bar",children:(0,t.jsx)("div",{className:"progress-fill",style:{width:"".concat(n,"%")}})}),(0,t.jsxs)("p",{className:"small",id:"overallText",children:[null!=e?e:0," / ",s," chapters"]})]})]}),(0,t.jsx)("h2",{className:"small muted",children:"Books"}),(0,t.jsx)("div",{className:"books-list",children:x.map(e=>(0,t.jsxs)("div",{className:"book-item",onClick:()=>window.dispatchEvent(new CustomEvent("openBibleBook",{detail:{bookId:e.id}})),children:[(0,t.jsx)("span",{children:e.name}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.chapters})]},e.id))})]})}function Posts(e){let{lang:a="en"}=e,[s,n]=(0,c.useState)([]),[i,l]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{let e=!0;return async function(){l(!0);try{let s=window.__POSTS;if(s&&Array.isArray(s))e&&n(s.slice(0,50));else{let s="/posts_".concat(a,".json"),t=await fetch(s);if(t.ok){let a=await t.json();e&&n(Array.isArray(a)?a.slice(0,50):[])}else if("en"!==a){let a=await fetch("/posts_en.json");if(a.ok){let s=await a.json();e&&n(Array.isArray(s)?s.slice(0,50):[])}}}}catch(e){console.warn("Failed to load posts",e)}finally{e&&l(!1)}}(),()=>{e=!1}},[a]),(0,t.jsxs)("section",{id:"posts-view",className:"card view-panel",children:[(0,t.jsx)("div",{className:"plans-header mb-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Posts"}),(0,t.jsx)("p",{className:"small muted",children:"Community posts and updates"})]})}),(0,t.jsxs)("div",{className:"posts-list space-y-3",children:[i&&(0,t.jsx)("div",{className:"muted",children:"Loading posts…"}),!i&&0===s.length&&(0,t.jsx)("div",{className:"small muted",children:"No posts available."}),s.map((e,a)=>(0,t.jsxs)("article",{className:"post-card border rounded p-3",children:[(0,t.jsxs)("div",{className:"post-head flex items-center gap-3",children:[(0,t.jsx)("div",{className:"avatar w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:e.author&&e.author[0]||"A"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.author||"Anonymous"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.time||""})]})]}),(0,t.jsx)("div",{className:"post-content mt-2 text-sm",children:e.content})]},a))]})]})}let f="kids-zone";function KidsZone(){let{user:e}=(0,d.a)(),a=(0,c.useRef)(null),[s,n]=(0,c.useState)(!1),[i,l]=(0,c.useState)([]),[r,o]=(0,c.useState)("local"),[m,h]=(0,c.useState)(""),[p,x]=(0,c.useState)(!1);async function refreshSessionAndFetch(){n(!0);try{if(!u.supabase){o("local"),l([]);return}let{data:e,error:a}=await u.supabase.from("kids_uploads").select("*").order("created_at",{ascending:!1});if(a||!e){o("local"),l([]);return}let s=await Promise.all(e.map(async e=>{if(!e.file_path)return{...e,signedUrl:null};try{let{data:a,error:s}=await u.supabase.storage.from(f).createSignedUrl(e.file_path,3600);if(s||!a)return{...e,signedUrl:null};return{...e,signedUrl:a.signedUrl||a.signed_url||null}}catch(a){return{...e,signedUrl:null}}}));o("supabase"),l(s)}catch(e){console.warn("refreshKidsFromSupabase failed",e),o("local"),l([])}finally{n(!1)}}async function handleUploadFile(a){if(a){if(!u.supabase){h("Supabase not configured");return}if(!e){h("Sign in to upload");return}h("Uploading…");try{let s="".concat(e.id,"/").concat(Date.now(),"-").concat(a.name),{error:t}=await u.supabase.storage.from(f).upload(s,a,{upsert:!1});if(t)throw t;let{error:n}=await u.supabase.from("kids_uploads").insert({user_id:e.id,file_path:s,kind:a.type||"image",approved:!1});if(n){try{await u.supabase.storage.from(f).remove([s])}catch(e){}throw n}h("Upload received (pending approval)"),await refreshSessionAndFetch()}catch(e){console.error("handleKidsUpload failed",e),h("Upload failed")}}}async function approveUpload(a){if(!p){alert("Only admins can approve");return}try{let{error:s}=await u.supabase.from("kids_uploads").update({approved:!0,approved_at:new Date().toISOString(),approved_by:(null==e?void 0:e.id)||null}).eq("id",a);if(s)throw s;await refreshSessionAndFetch()}catch(e){console.warn("approveKidsUpload failed",e),alert("Could not approve")}}async function deleteUpload(e,a){if(!p){alert("Only admins can delete");return}if(confirm("Delete this upload?"))try{if(a){let{error:e}=await u.supabase.storage.from(f).remove([a]);e&&console.warn("Storage remove error",e)}let{error:s}=await u.supabase.from("kids_uploads").delete().eq("id",e);s&&console.warn("DB delete error",s),await refreshSessionAndFetch()}catch(e){console.warn("deleteKidsUpload failed",e),alert("Delete failed")}}return(0,c.useEffect)(()=>{let a=!0;return async function(){await refreshSessionAndFetch();try{if(e){let{data:s,error:t}=await u.supabase.from("profiles").select("role").eq("id",e.id).maybeSingle();!t&&s&&("admin"===s.role||"super_admin"===s.role||"owner"===s.role)&&a&&x(!0)}}catch(e){}}(),()=>{a=!1}},[e]),(0,t.jsxs)("section",{id:"kids-view",className:"card view-panel",children:[(0,t.jsx)("div",{className:"plans-header mb-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Kids Corner \uD83C\uDFA8"}),(0,t.jsx)("p",{className:"small muted",children:"Creative gallery — upload and celebrate kids' artwork"})]})}),(0,t.jsxs)("div",{className:"kids-panel space-y-4",children:[(0,t.jsxs)("div",{className:"kids-controls flex items-center gap-3",children:[(0,t.jsx)("label",{className:"btn small-btn",htmlFor:"kidsUpload",children:"Upload"}),(0,t.jsx)("input",{id:"kidsUpload",ref:a,type:"file",accept:"image/*",className:"sr-only",onChange:e=>{let a=e.target.files&&e.target.files[0];a&&handleUploadFile(a),e.target.value=""}}),(0,t.jsxs)("div",{className:"kids-actions ml-auto flex gap-2",children:[e?(0,t.jsx)("button",{className:"btn small-btn",onClick:()=>{u.supabase.auth.signOut()},children:"Sign out"}):(0,t.jsx)("button",{className:"btn small-btn",onClick:()=>alert("Sign in via the profile modal"),children:"Sign in"}),(0,t.jsx)("button",{className:"btn small-btn",onClick:refreshSessionAndFetch,children:"Refresh"})]})]}),(0,t.jsxs)("div",{id:"kidsMetaRow",className:"flex items-center justify-between",children:[(0,t.jsx)("div",{id:"kidsStatus",className:"small muted",children:m||("supabase"===r?e?"Uploads fetched from Supabase.":"Sign in to upload (uploads hidden until approved).":"Using local sample gallery.")}),p&&(0,t.jsx)("div",{id:"kidsAdminHint",className:"pill pill-high",children:"Admin: approve or delete uploads below."})]}),(0,t.jsxs)("div",{id:"kidsGallery",className:"kids-grid grid gap-3 grid-cols-2 md:grid-cols-3",children:[s&&(0,t.jsx)("div",{className:"muted",children:"Loading…"}),!s&&0===i.length&&(0,t.jsx)("div",{className:"small muted",children:"No uploads yet."}),!s&&i.map(a=>(0,t.jsxs)("article",{className:"kid-card border rounded p-2",children:[(0,t.jsx)("div",{className:"kid-media mb-2",children:a.signedUrl?(0,t.jsx)("img",{src:a.signedUrl,alt:a.title||"Kids upload",loading:"lazy",className:"w-full h-40 object-cover"}):(0,t.jsx)("div",{className:"kid-placeholder h-40 flex items-center justify-center bg-gray-50",children:"\uD83C\uDFA8"})}),(0,t.jsxs)("div",{className:"kid-body",children:[(0,t.jsx)("div",{className:"font-medium",children:a.title||(a.file_path?a.file_path.split("/").pop():"Kids upload")}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:a.child||(a.user_id===(null==e?void 0:e.id)?"Uploaded by you":"Community upload")}),(0,t.jsxs)("div",{className:"mt-2 flex gap-2",children:[!a.approved&&p&&(0,t.jsx)("button",{className:"btn tiny",onClick:()=>approveUpload(a.id),children:"Approve"}),p&&(0,t.jsx)("button",{className:"btn tiny warn",onClick:()=>deleteUpload(a.id,a.file_path),children:"Delete"})]})]})]},a.id))]})]})]})}let g=createLucideIcon("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]),j=createLucideIcon("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),v=createLucideIcon("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),b=createLucideIcon("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),N=createLucideIcon("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),y=createLucideIcon("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),w=c.createContext();function NavigationProvider(e){let{children:a}=e,[s,n]=(0,c.useState)("home"),[i,l]=(0,c.useState)(!1);return(0,t.jsx)(w.Provider,{value:{activeView:s,setActiveView:n,drawerOpen:i,setDrawerOpen:l},children:a})}function useNavigation(){return(0,c.useContext)(w)}function Navigation(){let{activeView:e,setActiveView:a,drawerOpen:s,setDrawerOpen:n}=useNavigation(),i=[{id:"home",label:"Home",icon:g},{id:"books",label:"Bible",icon:j},{id:"plans",label:"Plans",icon:v},{id:"kids",label:"Kids",icon:b},{id:"posts",label:"Posts",icon:N},{id:"admin",label:"Admin",icon:y}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-40",children:(0,t.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,t.jsxs)("div",{className:"flex items-center justify-between min-w-full px-2 py-2",children:[(0,t.jsx)("div",{className:"flex gap-1 flex-1 overflow-x-auto",children:i.slice(0,5).map(s=>{let i=s.icon,l=e===s.id;return(0,t.jsxs)("button",{onClick:()=>{a(s.id),n(!1)},className:"flex flex-col items-center justify-center gap-1 px-3 py-2 rounded-lg transition-all whitespace-nowrap ".concat(l?"bg-gradient-to-br from-purple-500 to-indigo-600 text-white shadow-md":"text-gray-600 hover:bg-gray-100"),"aria-label":s.label,children:[(0,t.jsx)(i,{size:20}),(0,t.jsx)("span",{className:"text-xs font-medium",children:s.label})]},s.id)})}),(0,t.jsxs)("button",{onClick:()=>n(!s),className:"flex flex-col items-center justify-center gap-1 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-all ml-2","aria-label":"More options",children:[(0,t.jsx)(h,{size:20}),(0,t.jsx)("span",{className:"text-xs font-medium",children:"More"})]})]})})}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/30 z-30",onClick:()=>n(!1)}),(0,t.jsx)("div",{className:"fixed bottom-16 right-2 bg-white rounded-lg shadow-lg border border-gray-200 z-40 p-2 space-y-1",children:i.slice(5).map(s=>{let i=s.icon,l=e===s.id;return(0,t.jsxs)("button",{onClick:()=>{a(s.id),n(!1)},className:"w-full flex items-center gap-3 px-4 py-2 rounded-lg transition-all ".concat(l?"bg-gradient-to-r from-purple-500 to-indigo-600 text-white":"text-gray-600 hover:bg-gray-100"),children:[(0,t.jsx)(i,{size:18}),(0,t.jsx)("span",{className:"text-sm font-medium",children:s.label})]},s.id)})})]})]})}function PageContent(){let{activeView:e}=useNavigation();return(0,t.jsxs)("main",{className:"pb-32",children:[(0,t.jsx)("aside",{className:"sidebar drawer",id:"booksSidebar",children:(0,t.jsx)(BooksSidebar,{})}),(0,t.jsxs)("div",{className:"right-pane",children:["home"===e&&(0,t.jsx)(Home,{}),"plans"===e&&(0,t.jsx)("section",{className:"card view-panel",children:(0,t.jsx)(Plans,{})}),"kids"===e&&(0,t.jsx)("section",{className:"card view-panel",children:(0,t.jsx)(KidsZone,{})}),"posts"===e&&(0,t.jsx)("section",{className:"card view-panel",children:(0,t.jsx)(Posts,{})}),"books"===e&&(0,t.jsx)("section",{className:"card view-panel",children:(0,t.jsx)(Books,{})}),"admin"===e&&(0,t.jsx)(Admin,{})]})]})}function HomePage(){return(0,c.useEffect)(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").catch(e=>{console.log("SW registration failed:",e)})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i(),{children:[(0,t.jsx)("title",{children:"Bible Reading Tracker"}),(0,t.jsx)("link",{rel:"icon",type:"image/svg+xml",href:"/favicon.svg"}),(0,t.jsx)("link",{rel:"manifest",href:"/manifest.webmanifest"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("meta",{name:"theme-color",content:"#4b0082"})]}),(0,t.jsx)(NavigationProvider,{children:(0,t.jsxs)(Layout,{children:[(0,t.jsx)(PageContent,{}),(0,t.jsx)("div",{className:"fixed inset-0 pointer-events-none",children:(0,t.jsx)(Auth,{})}),(0,t.jsx)(Navigation,{})]})}),(0,t.jsx)(r(),{src:"/data/embedded-plans.js?v=9",strategy:"beforeInteractive"}),(0,t.jsx)(r(),{src:"/public-env.js?v=9",strategy:"beforeInteractive"})]})}},9008:function(e,a,s){e.exports=s(9201)},4298:function(e,a,s){e.exports=s(5354)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5728)}),_N_E=e.O()}]);